diff -Naur LibVNCServer-0.9.9/libvncclient/rfbproto.c LibVNCServer-0.9.9.new/libvncclient/rfbproto.c
--- LibVNCServer-0.9.9/libvncclient/rfbproto.c	2012-05-04 16:19:00.000000000 +0200
+++ LibVNCServer-0.9.9.new/libvncclient/rfbproto.c	2014-09-27 09:40:13.675884700 +0200
@@ -1807,7 +1807,8 @@
 	client->updateRect.x = client->updateRect.y = 0;
 	client->updateRect.w = client->width;
 	client->updateRect.h = client->height;
-	client->MallocFrameBuffer(client);
+  if (!client->MallocFrameBuffer(client))
+    return FALSE;
 	SendFramebufferUpdateRequest(client, 0, 0, rect.r.w, rect.r.h, FALSE);
 	rfbClientLog("Got new framebuffer size: %dx%d\n", rect.r.w, rect.r.h);
 	continue;
@@ -2260,7 +2261,8 @@
     client->updateRect.x = client->updateRect.y = 0;
     client->updateRect.w = client->width;
     client->updateRect.h = client->height;
-    client->MallocFrameBuffer(client);
+    if (!client->MallocFrameBuffer(client))
+      return FALSE;
     SendFramebufferUpdateRequest(client, 0, 0, client->width, client->height, FALSE);
     rfbClientLog("Got new framebuffer size: %dx%d\n", client->width, client->height);
     break;
@@ -2276,7 +2278,9 @@
     client->updateRect.x = client->updateRect.y = 0;
     client->updateRect.w = client->width;
     client->updateRect.h = client->height;
-    client->MallocFrameBuffer(client);
+    if (!client->MallocFrameBuffer(client))
+      return FALSE;
+
     SendFramebufferUpdateRequest(client, 0, 0, client->width, client->height, FALSE);
     rfbClientLog("Got new framebuffer size: %dx%d\n", client->width, client->height);
     break;
diff -Naur LibVNCServer-0.9.9/libvncclient/vncviewer.c LibVNCServer-0.9.9.new/libvncclient/vncviewer.c
--- LibVNCServer-0.9.9/libvncclient/vncviewer.c	2012-05-04 16:19:00.000000000 +0200
+++ LibVNCServer-0.9.9.new/libvncclient/vncviewer.c	2014-09-27 09:38:01.323314600 +0200
@@ -225,7 +225,8 @@
 
   client->width=client->si.framebufferWidth;
   client->height=client->si.framebufferHeight;
-  client->MallocFrameBuffer(client);
+  if (!client->MallocFrameBuffer(client))
+    return FALSE;
 
   if (!SetFormatAndEncodings(client))
     return FALSE;
