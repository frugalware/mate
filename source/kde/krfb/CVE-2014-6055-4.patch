From: Martin T. H. Sandsmark <martin.sandsmark@kde.org>
Date: Tue, 23 Sep 2014 15:54:11 +0000
Subject: libvncserver: Fix stack-based buffer overflow in rfbFileTransferOffer message, FileTime processing
X-Git-Url: http://quickgit.kde.org/?p=krfb.git&a=commitdiff&h=857c2b411ed806ef806116407612a2d2a40fab9c
---
libvncserver: Fix stack-based buffer overflow in rfbFileTransferOffer message, FileTime processing

Upstream commit: f528072216dec01cee7ca35d94e171a3b909e677

CVE-2014-6055
---


--- a/libvncserver/rfbserver.c
+++ b/libvncserver/rfbserver.c
@@ -1602,7 +1602,8 @@
         p = strrchr(buffer, ',');
         if (p!=NULL) {
             *p = '\0';
-            strcpy(szFileTime, p+1);
+            strncpy(szFileTime, p+1, sizeof(szFileTime));
+            szFileTime[sizeof(szFileTime)-1] = '\x00'; /* ensure NULL terminating byte is present, even if copy overflowed */
         } else
             szFileTime[0]=0;
 
