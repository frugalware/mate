#! /bin/sh /usr/share/dpatch/dpatch-run
# DP: Description: denial of service via different line lengths
# DP: Origin: backport, http://git.gnupg.org/cgi-bin/gitweb.cgi?p=gpgme.git;a=commit;h=2cbd76f7911fc215845e89b50d6af5ff4a83dd77
# DP: Bug-Debian: https://bugs.debian.org/756651
# DP: Bug-SuSE: https://bugzilla.novell.com/show_bug.cgi?id=890123
# DP: Bug-RedHat: https://bugzilla.redhat.com/show_bug.cgi?id=1113267
@DPATCH@
diff -urNad '--exclude=CVS' '--exclude=.svn' '--exclude=.git' '--exclude=.arch' '--exclude=.hg' '--exclude=_darcs' '--exclude=.bzr' gpgme1.0-1.2.0~/src/engine-gpgsm.c gpgme1.0-1.2.0/src/engine-gpgsm.c
--- gpgme1.0-1.2.0~/src/engine-gpgsm.c	2009-06-17 08:36:07.000000000 -0400
+++ gpgme1.0-1.2.0/src/engine-gpgsm.c	2014-08-01 09:45:02.165096307 -0400
@@ -959,7 +959,7 @@
 	      else
 		{
 		  *aline = newline;
-		  gpgsm->colon.attic.linesize += linelen + 1;
+		  gpgsm->colon.attic.linesize = *alinelen + linelen + 1;
 		}
 	    }
 	  if (!err)
