commit 215968fa8ff33e327f0600765a5caa24de392cbc
Author: Paul Richards <paul@mantisforge.org>
Date:   Sat Oct 12 22:58:43 2013 +0100

    Strip null bytes out of GPC input strings
    
    Backporting commit fc02c46eea9d9e7cc472a7fc1801ea65d467db76 from master
    branch to fix issue #17640
    
    Signed-off-by: Damien Regad <dregad@mantisbt.org>

diff --git a/core/gpc_api.php b/core/gpc_api.php
index 2daad98..58e0827 100644
--- a/core/gpc_api.php
+++ b/core/gpc_api.php
@@ -110,7 +110,7 @@ function gpc_get_string( $p_var_name, $p_default = null ) {
 		trigger_error( ERROR_GPC_ARRAY_UNEXPECTED, ERROR );
 	}
 
-	return $t_result;
+	return str_replace( "\0","",$t_result );
 }
 
 /**
@@ -255,7 +255,11 @@ function gpc_get_string_array( $p_var_name, $p_default = null ) {
 		trigger_error( ERROR_GPC_ARRAY_EXPECTED, ERROR );
 	}
 
-	return $t_result;
+	$t_array = array();
+	foreach( $t_result as $key => $val ) {
+		$t_array[$key] = str_replace( "\0", "", $val );
+	}
+	return $t_array;
 }
 
 /**
