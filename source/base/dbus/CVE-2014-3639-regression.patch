Description: fix authentication timeout on certain slower systems
Bug: https://bugs.freedesktop.org/show_bug.cgi?id=86431
Origin: upstream, http://cgit.freedesktop.org/dbus/dbus/commit/?h=dbus-1.8&id=29c64424d174a20449846479e7eeaa87821d78be
Origin: upstream, http://cgit.freedesktop.org/dbus/dbus/commit/?h=dbus-1.8&id=02e1ddf91e27405c0b88303bb49f5bf5c56306f8

Index: dbus-1.8.8/bus/config-parser.c
===================================================================
--- dbus-1.8.8.orig/bus/config-parser.c	2014-11-25 14:21:58.896366122 -0500
+++ dbus-1.8.8/bus/config-parser.c	2014-11-25 14:22:35.516676410 -0500
@@ -439,7 +439,7 @@
        * and legitimate auth will fail.  If interactive auth (ask user for
        * password) is allowed, then potentially it has to be quite long.
        */
-      parser->limits.auth_timeout = 5000; /* 5 seconds */
+      parser->limits.auth_timeout = 30000; /* 30 seconds */
 
       /* Do not allow a fd to stay forever in dbus-daemon
        * https://bugs.freedesktop.org/show_bug.cgi?id=80559
Index: dbus-1.8.8/bus/connection.c
===================================================================
--- dbus-1.8.8.orig/bus/connection.c	2014-11-25 14:21:58.948366562 -0500
+++ dbus-1.8.8/bus/connection.c	2014-11-25 14:22:32.048647012 -0500
@@ -882,6 +882,14 @@
 
           if (elapsed >= (double) auth_timeout)
             {
+              /* Unfortunately, we can't identify the connection: it doesn't
+               * have a unique name yet, we don't know its uid/pid yet,
+               * and so on. */
+              bus_context_log (connections->context, DBUS_SYSTEM_LOG_INFO,
+                  "Connection has not authenticated soon enough, closing it "
+                  "(auth_timeout=%dms, elapsed: %.0fms)",
+                  auth_timeout, elapsed);
+
               _dbus_verbose ("Timing out authentication for connection %p\n", connection);
               dbus_connection_close (connection);
             }
